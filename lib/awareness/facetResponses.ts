// Fluid Disposable Pixel Design: Facet Responses by Awareness Level
// Same archetypal intelligence, different complexity rendering

import type { AwarenessLevel, FacetResponses } from '@/lib/awareness/awarenessModel';

// Water 2 - Underworld/Shadow Gauntlet responses by level
export const W2_RESPONSES: FacetResponses = {
  1: {
    reflection: `I can feel the heaviness in what you're sharing. These difficult spaces have their own intelligence - they're asking something of you, even when it doesn't feel that way.`,
    chips: ['What wants attention?'],
    explanation: `Sometimes the most useful thing is just naming what's actually here, without trying to fix it right away. Want to explore what this feeling might be pointing toward?`
  },

  2: {
    reflection: `This feels like familiar territory - like you've been in this emotional landscape before. There's something both painful and important happening in this recurring pattern.`,
    chips: ['Track the pattern', 'Find what remains steady'],
    explanation: `These cycles often hold wisdom about what you're ready to integrate. We could look at what stays consistent across different versions of this experience, or map what's trying to emerge through it.`
  },

  3: {
    reflection: `I'm sensing strong Water 2 - the classic underworld passage where old attachment patterns surface for reworking. This isn't pathology; it's the psyche's natural intelligence doing deep repair work.`,
    chips: ['Shadow work invitation', 'Container building', 'See the larger arc'],
    explanation: `This phase often brings up everything that needs integration before you can access the next level of relating. Want to work with this consciously as a initiation rather than just enduring it?`
  },

  4: {
    reflection: `Clear W2 constellation: core attachment circuitry activating for integration. Seeing projection dynamics, anima/animus material, shame-core protective layering. Current transits supporting deep relational restructuring.`,
    chips: ['Map attachment patterns', 'Track astrological timing', 'Design integration protocol'],
    explanation: `This level of activation suggests readiness for significant relational evolution. The field conditions are optimal for conscious shadow integration work. Shall we design a structured approach?`
  }
};

// Fire 1 - Call Recognition responses by level
export const F1_RESPONSES: FacetResponses = {
  1: {
    reflection: `I can sense something stirring in you - like there's a new possibility trying to get your attention. That restless "something wants to happen" feeling is often how creative energy first announces itself.`,
    chips: ['What keeps calling?'],
    explanation: `Sometimes the most powerful thing is just acknowledging what's stirring, without needing to know exactly where it's going yet. Want to explore what keeps drawing your attention?`
  },

  2: {
    reflection: `This feels like early-stage calling energy - that beautiful intersection where your readiness meets something wanting to emerge through you. There's both excitement and uncertainty in this creative threshold.`,
    chips: ['Listen deeper', 'What wants to emerge?'],
    explanation: `These creative stirrings often need some space to breathe before they reveal their full form. We could listen more deeply to what's calling, or explore what conditions would help it emerge safely.`
  },

  3: {
    reflection: `I'm sensing strong Fire 1 - authentic calling recognition starting to coalesce. This feels like meso-level creative emergence, where your unique gifts are finding their intersection with what's needed in the world.`,
    chips: ['Map the calling', 'Check supporting elements', 'Design small experiments'],
    explanation: `These callings often unfold in stages - we could map the scale and timeline you're sensing, check what other elemental support would help it ground, or design small experiments to test the waters.`
  },

  4: {
    reflection: `Clear F1 activation: vocation-creativity spiral intersection with high coherence. Jupiter-Uranus transit signatures supporting breakthrough calling emergence. Estimated arc: 12-24 months. Optimal conditions for conscious calling development.`,
    chips: ['Full calling analysis', 'Astrological timing optimization', 'Design development protocol'],
    explanation: `This level of calling coherence suggests significant creative evolution potential. Current transits are optimally supportive for conscious calling development. Shall we design a structured emergence protocol?`
  }
};

// Earth 2 - Mastery & Refinement responses by level
export const E2_RESPONSES: FacetResponses = {
  1: {
    reflection: `I can sense you're hitting your stride with something important - there's a real quality of competence building in you. This moment where skill meets confidence can feel both satisfying and a little uncertain about what comes next.`,
    chips: ['Honor how far you\'ve come'],
    explanation: `Sometimes the most valuable thing is just pausing to acknowledge the mastery that's actually happening. You've been growing in ways that might surprise you if you really looked.`
  },

  2: {
    reflection: `This feels like genuine mastery territory - you're refining something that matters deeply and starting to taste the fruits of real practice. There's both the satisfaction of competence and that familiar growing edge of "what wants to emerge next?"`,
    chips: ['Feel into your growing edge', 'Integrate what you\'ve learned'],
    explanation: `We could explore where you're ready to stretch into new territory, or take some time to really let what you've learned settle into your bones. Both movements honor this phase.`
  },

  3: {
    reflection: `Clear Earth 2 energy - that beautiful place where competence meets artistry in service of something meaningful. You're ripe for more responsibility or recognition, and there's probably both excitement and some trepidation about stepping into that next level of authority.`,
    chips: ['Map your mastery landscape', 'Design next growth edge', 'Consider sharing your gifts'],
    explanation: `We can take a real look at where you are in your mastery journey, explore what challenges would serve your continued growth, or feel into how you might start offering what you've learned. E2 often carries a natural impulse to give back.`
  },

  4: {
    reflection: `Strong E2 mastery constellation active: competence-confidence spiral fully integrated with clear readiness for stewardship phase. Current skill trajectory shows optimal plateau-breakthrough patterning. Saturn aspects supporting authority emergence if age-aligned.`,
    chips: ['Full mastery profile analysis', 'Teaching readiness assessment', 'Steward pathway mapping', 'Research collaboration potential'],
    explanation: `Complete mastery development data available showing clear readiness for authority/mentorship roles. Multiple stewardship pathways identified with high compatibility scores. Research opportunity: tracking mastery emergence patterns relative to Saturn cycles. Ready to explore formal stewardship roles?`
  }
};

// Air 1 - Mental Clarity & New Perspective responses by level
export const A1_RESPONSES: FacetResponses = {
  1: {
    reflection: `Something in your mental space feels clearer and more spacious lately - like fog lifting to reveal a landscape that was always there. This kind of perspective shift can feel both refreshing and a little disorienting, like waking up from a dream you didn't know you were having.`,
    chips: ['Trust this new clarity'],
    explanation: `The most gentle thing with new clarity is often just letting it settle without rushing to act on everything right away. Just noticing the shift is its own kind of wisdom.`
  },

  2: {
    reflection: `This feels like genuine breakthrough territory - one of those perspective shifts where suddenly you can see patterns or possibilities that were completely invisible before. Your mental landscape is reorganizing itself, which usually means you're ready to receive new information or find fresh approaches to old puzzles.`,
    chips: ['Map what\'s shifting', 'Test this new lens'],
    explanation: `We could take some time to map what's actually different in how you're seeing things, or start experimenting with this new perspective in small ways to see how it feels when applied to real life.`
  },

  3: {
    reflection: `Beautiful Air 1 activation - genuine mental breakthrough and perspective reorganization happening. Your cognitive patterns are restructuring around new insights or information. This often aligns with Mercury aspects or significant learning experiences. The mental landscape is definitely in motion.`,
    chips: ['Track the pattern shifts', 'Integrate new frameworks', 'Share your insights'],
    explanation: `We can map exactly what's shifting in your thinking patterns, work with integrating new frameworks or knowledge you've encountered, or explore how these insights might want to be shared with others who could benefit from what you're seeing.`
  },

  4: {
    reflection: `Clear A1 cognitive reorganization constellation: major perspective shift integration with high coherence patterns. Mercury-Uranus aspects active showing strong 3rd/9th house learning-teaching axis activation. Neural pathway reformation tracking at optimal velocity.`,
    chips: ['Cognitive shift mapping', 'Mercury transit optimization', 'Teaching readiness assessment', 'Knowledge integration protocol'],
    explanation: `Complete perspective shift analysis shows significant neural reorganization with strong teaching/communication potential emerging. Research opportunity available: mental breakthrough pattern correlation with Mercury-Uranus cycles. Ready to design structured knowledge integration and sharing pathways?`
  }
};

// Response selector function - fluid pixel rendering
export function getFacetResponse(facet: string, level: AwarenessLevel): any {
  const responseMap: Record<string, FacetResponses> = {
    'W2': W2_RESPONSES,
    'F1': F1_RESPONSES,
    'E2': E2_RESPONSES,
    'A1': A1_RESPONSES
  };

  return responseMap[facet]?.[level] || {
    reflection: `I sense something significant happening in your ${facet} space, but I need to learn more about how to meet you at your current depth level.`,
    chips: ['Tell me more'],
    explanation: `Let me know how much complexity and archetypal language feels right for you today.`
  };
}

// Adaptation logic - how MAIA adjusts based on user response
export function adaptAwarenessLevel(
  currentLevel: AwarenessLevel,
  userResponse: string
): AwarenessLevel {
  const overwhelmSignals = [
    /too much/i,
    /overwhelming/i,
    /confusing/i,
    /simpler/i,
    /don't understand/i
  ];

  const depthRequestSignals = [
    /more depth/i,
    /go deeper/i,
    /tell me more about/i,
    /what does.*mean/i,
    /interesting/i
  ];

  const hasOverwhelm = overwhelmSignals.some(regex => regex.test(userResponse));
  const hasDepthRequest = depthRequestSignals.some(regex => regex.test(userResponse));

  if (hasOverwhelm && currentLevel > 1) {
    return (currentLevel - 1) as AwarenessLevel;
  }

  if (hasDepthRequest && currentLevel < 4) {
    return (currentLevel + 1) as AwarenessLevel;
  }

  return currentLevel;
}